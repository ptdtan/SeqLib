<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SnowTools: src/SnowTools/BamRead.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>src/SnowTools/BamRead.h</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef SNOWTOOLS_READ_H__</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define SNOWTOOLS_READ_H__</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;cstdint&gt;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;memory&gt;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;sstream&gt;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;unordered_map&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;algorithm&gt;</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;htslib/hts.h&quot;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;htslib/sam.h&quot;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;htslib/bgzf.h&quot;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;htslib/kstring.h&quot;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &quot;htslib/faidx.h&quot;</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;SnowTools/GenomicRegion.h&quot;</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> BASES[16] = {<span class="charliteral">&apos; &apos;</span>, <span class="charliteral">&apos;A&apos;</span>, <span class="charliteral">&apos;C&apos;</span>, <span class="charliteral">&apos; &apos;</span>,
<a name="l00021"></a>00021                                <span class="charliteral">&apos;G&apos;</span>, <span class="charliteral">&apos; &apos;</span>, <span class="charliteral">&apos; &apos;</span>, <span class="charliteral">&apos; &apos;</span>, 
<a name="l00022"></a>00022                                <span class="charliteral">&apos;T&apos;</span>, <span class="charliteral">&apos; &apos;</span>, <span class="charliteral">&apos; &apos;</span>, <span class="charliteral">&apos; &apos;</span>, 
<a name="l00023"></a>00023                                <span class="charliteral">&apos; &apos;</span>, <span class="charliteral">&apos; &apos;</span>, <span class="charliteral">&apos; &apos;</span>, <span class="charliteral">&apos;N&apos;</span>};
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="comment">//#include &quot;SnowTools/HTSTools.h&quot;</span>
<a name="l00026"></a>00026 
<a name="l00027"></a><a class="code" href="namespaceSnowTools.html">00027</a> <span class="keyword">namespace </span>SnowTools {
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="keyword">enum class</span> Base { A = 1, C = 2, G = 4, T = 8, N = 15 };
<a name="l00030"></a>00030 
<a name="l00033"></a><a class="code" href="structSnowTools_1_1CigarField.html">00033</a> <span class="keyword">struct </span><a class="code" href="structSnowTools_1_1CigarField.html">CigarField</a> {
<a name="l00034"></a>00034   
<a name="l00035"></a><a class="code" href="structSnowTools_1_1CigarField.html#a9f58a5fa8ba287b093986144e37a565c">00035</a>   <span class="keywordtype">char</span> <a class="code" href="structSnowTools_1_1CigarField.html#a9f58a5fa8ba287b093986144e37a565c">Type</a>; 
<a name="l00036"></a><a class="code" href="structSnowTools_1_1CigarField.html#af8d8a0e464944d6e219e87ef2f33d2e0">00036</a>   uint32_t <a class="code" href="structSnowTools_1_1CigarField.html#af8d8a0e464944d6e219e87ef2f33d2e0">Length</a>; 
<a name="l00038"></a>00038   <a class="code" href="structSnowTools_1_1CigarField.html">CigarField</a>(<span class="keywordtype">char</span> t, uint32_t l) : <a class="code" href="structSnowTools_1_1CigarField.html#a9f58a5fa8ba287b093986144e37a565c">Type</a>(t), <a class="code" href="structSnowTools_1_1CigarField.html#af8d8a0e464944d6e219e87ef2f33d2e0">Length</a>(l) {}
<a name="l00039"></a>00039 
<a name="l00040"></a>00040   <span class="keyword">friend</span> std::ostream&amp; operator&lt;&lt;(std::ostream&amp; out, <span class="keyword">const</span> <a class="code" href="structSnowTools_1_1CigarField.html">CigarField</a>&amp; c) { out &lt;&lt; c.<a class="code" href="structSnowTools_1_1CigarField.html#a9f58a5fa8ba287b093986144e37a565c">Type</a> &lt;&lt; c.<a class="code" href="structSnowTools_1_1CigarField.html#af8d8a0e464944d6e219e87ef2f33d2e0">Length</a>; <span class="keywordflow">return</span> out; }
<a name="l00041"></a>00041   
<a name="l00042"></a>00042 };
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="keyword">typedef</span> std::vector&lt;CigarField&gt; Cigar;
<a name="l00046"></a>00046 <span class="keyword">typedef</span> std::unordered_map&lt;std::string, size_t&gt; CigarMap;
<a name="l00047"></a>00047 
<a name="l00056"></a><a class="code" href="classSnowTools_1_1BamRead.html">00056</a> <span class="keyword">class </span><a class="code" href="classSnowTools_1_1BamRead.html">BamRead</a> {
<a name="l00057"></a>00057 
<a name="l00058"></a>00058   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classSnowTools_1_1BWAWrapper.html">BWAWrapper</a>;
<a name="l00059"></a>00059 
<a name="l00060"></a>00060  <span class="keyword">public</span>:
<a name="l00061"></a>00061   
<a name="l00064"></a>00064   <span class="keywordtype">void</span> <a class="code" href="classSnowTools_1_1BamRead.html#a02fd73d861ef2e4aabb38c0c9ff82947">init</a>();
<a name="l00065"></a>00065 
<a name="l00071"></a>00071   <span class="keywordtype">void</span> <a class="code" href="classSnowTools_1_1BamRead.html#af1d3aa3591fce81d05b5515154181c70">assign</a>(bam1_t* a);
<a name="l00072"></a>00072 
<a name="l00074"></a><a class="code" href="classSnowTools_1_1BamRead.html#a9c52958d3fa4c3fdf59ebfb63e5f1dc1">00074</a>   <a class="code" href="classSnowTools_1_1BamRead.html#a9c52958d3fa4c3fdf59ebfb63e5f1dc1">BamRead</a>() : m_hdr(nullptr) {}
<a name="l00075"></a>00075 
<a name="l00077"></a><a class="code" href="classSnowTools_1_1BamRead.html#a20e39d0a44668c55b436cd7fd7d534d5">00077</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classSnowTools_1_1BamRead.html#a20e39d0a44668c55b436cd7fd7d534d5">ReverseFlag</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (b-&gt;core.flag&amp;BAM_FREVERSE) != 0; }
<a name="l00078"></a>00078 
<a name="l00080"></a><a class="code" href="classSnowTools_1_1BamRead.html#adcfaba5e50f7a799cb8d4d89fa5afae6">00080</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classSnowTools_1_1BamRead.html#adcfaba5e50f7a799cb8d4d89fa5afae6">MateReverseFlag</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (b-&gt;core.flag&amp;BAM_FMREVERSE) != 0; }
<a name="l00081"></a>00081 
<a name="l00083"></a><a class="code" href="classSnowTools_1_1BamRead.html#aa514c3ef20f1e7d98eb5d373fb8da356">00083</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classSnowTools_1_1BamRead.html#aa514c3ef20f1e7d98eb5d373fb8da356">Interchromosomal</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> b-&gt;core.tid != b-&gt;core.mtid; }
<a name="l00084"></a>00084 
<a name="l00086"></a><a class="code" href="classSnowTools_1_1BamRead.html#a7e60fc868c1af3555fb8bc1e81d3078d">00086</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classSnowTools_1_1BamRead.html#a7e60fc868c1af3555fb8bc1e81d3078d">DuplicateFlag</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (b-&gt;core.flag&amp;BAM_FDUP) != 0; }
<a name="l00087"></a>00087 
<a name="l00089"></a><a class="code" href="classSnowTools_1_1BamRead.html#a7ae334e53a310a160b86b9b6168eacf1">00089</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classSnowTools_1_1BamRead.html#a7ae334e53a310a160b86b9b6168eacf1">SecondaryFlag</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (b-&gt;core.flag&amp;BAM_FSECONDARY) != 0; }
<a name="l00090"></a>00090 
<a name="l00092"></a><a class="code" href="classSnowTools_1_1BamRead.html#abd8b975557b92d9828c7b884d840ccab">00092</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classSnowTools_1_1BamRead.html#abd8b975557b92d9828c7b884d840ccab">QCFailFlag</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (b-&gt;core.flag&amp;BAM_FQCFAIL) != 0; }
<a name="l00093"></a>00093 
<a name="l00095"></a><a class="code" href="classSnowTools_1_1BamRead.html#ad49ec8ab930027b45d5705c043726af5">00095</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classSnowTools_1_1BamRead.html#ad49ec8ab930027b45d5705c043726af5">MappedFlag</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (b-&gt;core.flag&amp;BAM_FUNMAP) == 0; }
<a name="l00096"></a>00096 
<a name="l00098"></a><a class="code" href="classSnowTools_1_1BamRead.html#af9c4451e82b8058d7bff9d99c6de01dd">00098</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classSnowTools_1_1BamRead.html#af9c4451e82b8058d7bff9d99c6de01dd">MateMappedFlag</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (b-&gt;core.flag&amp;BAM_FMUNMAP) == 0; }
<a name="l00099"></a>00099 
<a name="l00101"></a><a class="code" href="classSnowTools_1_1BamRead.html#ad4ab6b24a51712e0a8ce89e492d1d38e">00101</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classSnowTools_1_1BamRead.html#ad4ab6b24a51712e0a8ce89e492d1d38e">PairMappedFlag</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !(b-&gt;core.flag&amp;BAM_FMUNMAP) &amp;&amp; !(b-&gt;core.flag&amp;BAM_FUNMAP); }
<a name="l00102"></a>00102 
<a name="l00104"></a>00104   int32_t <a class="code" href="classSnowTools_1_1BamRead.html#a0dcbc1e45f86d3c2b22701a7d6afa43b">CountNBases</a>() <span class="keyword">const</span>;
<a name="l00105"></a>00105 
<a name="l00107"></a>00107   <span class="keywordtype">void</span> <a class="code" href="classSnowTools_1_1BamRead.html#ab479d342def7b30ecb7d15bc29c4cc12">QualityTrimmedSequence</a>(int32_t qualTrim, int32_t&amp; startpoint, int32_t&amp; endpoint) <span class="keyword">const</span>;
<a name="l00108"></a>00108 
<a name="l00110"></a>00110   std::string <a class="code" href="classSnowTools_1_1BamRead.html#ae09627143c815100d284c660962c5571">QualitySequence</a>() <span class="keyword">const</span>;
<a name="l00111"></a>00111 
<a name="l00113"></a><a class="code" href="classSnowTools_1_1BamRead.html#a6fd3f2218c3245356bd3f841616d208e">00113</a>   <span class="keyword">inline</span> int32_t <a class="code" href="classSnowTools_1_1BamRead.html#a6fd3f2218c3245356bd3f841616d208e">Position</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> b-&gt;core.pos; }
<a name="l00114"></a>00114   
<a name="l00116"></a><a class="code" href="classSnowTools_1_1BamRead.html#a6a602cda286b646dd00170fec4bdd353">00116</a>   <span class="keyword">inline</span> int32_t <a class="code" href="classSnowTools_1_1BamRead.html#a6a602cda286b646dd00170fec4bdd353">MatePosition</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> b-&gt;core.mpos; }
<a name="l00117"></a>00117 
<a name="l00119"></a>00119   int32_t <a class="code" href="classSnowTools_1_1BamRead.html#a8a7ff870ffc4987d1c596412a61a5292">CountSecondaryAlignments</a>() <span class="keyword">const</span>;
<a name="l00120"></a>00120 
<a name="l00122"></a><a class="code" href="classSnowTools_1_1BamRead.html#a1674436fb351427ebcba8da38823b53d">00122</a>   <span class="keyword">inline</span> int32_t <a class="code" href="classSnowTools_1_1BamRead.html#a1674436fb351427ebcba8da38823b53d">PositionEnd</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> bam_endpos(b.get()); }
<a name="l00123"></a>00123 
<a name="l00125"></a><a class="code" href="classSnowTools_1_1BamRead.html#afbd518132e9a953ba6b4059f273b5168">00125</a>   <span class="keyword">inline</span> int32_t <a class="code" href="classSnowTools_1_1BamRead.html#afbd518132e9a953ba6b4059f273b5168">ChrID</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> b-&gt;core.tid; }
<a name="l00126"></a>00126   
<a name="l00128"></a><a class="code" href="classSnowTools_1_1BamRead.html#a26c0c601f0843ebb0e3ad6523ec9ba79">00128</a>   <span class="keyword">inline</span> int32_t <a class="code" href="classSnowTools_1_1BamRead.html#a26c0c601f0843ebb0e3ad6523ec9ba79">MateChrID</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> b-&gt;core.mtid; }
<a name="l00129"></a>00129   
<a name="l00131"></a><a class="code" href="classSnowTools_1_1BamRead.html#a18669c497e243e6ee41e19bed2500b32">00131</a>   <span class="keyword">inline</span> int32_t <a class="code" href="classSnowTools_1_1BamRead.html#a18669c497e243e6ee41e19bed2500b32">MapQuality</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> b-&gt;core.qual; }
<a name="l00132"></a>00132   
<a name="l00134"></a><a class="code" href="classSnowTools_1_1BamRead.html#a27093dc5aa273054170b9f550038bb41">00134</a>   <span class="keyword">inline</span> int32_t <a class="code" href="classSnowTools_1_1BamRead.html#a27093dc5aa273054170b9f550038bb41">CigarSize</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> b-&gt;core.n_cigar; }
<a name="l00135"></a>00135   
<a name="l00137"></a><a class="code" href="classSnowTools_1_1BamRead.html#aca866c832b39259ef75ed58fefcbded9">00137</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classSnowTools_1_1BamRead.html#aca866c832b39259ef75ed58fefcbded9">FirstFlag</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (b-&gt;core.flag&amp;BAM_FREAD1); }
<a name="l00138"></a>00138   
<a name="l00140"></a><a class="code" href="classSnowTools_1_1BamRead.html#a98694bf297ed2b002773ededb9b7f0c9">00140</a>   <span class="keyword">inline</span> std::string <a class="code" href="classSnowTools_1_1BamRead.html#a98694bf297ed2b002773ededb9b7f0c9">Qname</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> std::string(bam_get_qname(b)); }
<a name="l00141"></a>00141   
<a name="l00143"></a><a class="code" href="classSnowTools_1_1BamRead.html#a7c168c49357c6ceb03cfb72b7b2d15e7">00143</a>   <span class="keyword">inline</span> <span class="keywordtype">char</span>* <a class="code" href="classSnowTools_1_1BamRead.html#a7c168c49357c6ceb03cfb72b7b2d15e7">QnameChar</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> bam_get_qname(b); }
<a name="l00144"></a>00144   
<a name="l00146"></a><a class="code" href="classSnowTools_1_1BamRead.html#a2c8222913a2e64f734cdcbc0d616b2ed">00146</a>   <span class="keyword">inline</span> int32_t <a class="code" href="classSnowTools_1_1BamRead.html#a2c8222913a2e64f734cdcbc0d616b2ed">AlignmentFlag</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> b-&gt;core.flag; }
<a name="l00147"></a>00147   
<a name="l00149"></a><a class="code" href="classSnowTools_1_1BamRead.html#a1850a3aa2bdd222c675a9af449151ed8">00149</a>   <span class="keyword">inline</span> int32_t <a class="code" href="classSnowTools_1_1BamRead.html#a1850a3aa2bdd222c675a9af449151ed8">InsertSize</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> b-&gt;core.isize; } 
<a name="l00150"></a>00150   
<a name="l00152"></a><a class="code" href="classSnowTools_1_1BamRead.html#a407e59e0a5addbdeff41217027bbddb0">00152</a>   <span class="keyword">inline</span> int32_t <a class="code" href="classSnowTools_1_1BamRead.html#a407e59e0a5addbdeff41217027bbddb0">Length</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> b-&gt;core.l_qseq; }
<a name="l00153"></a>00153   
<a name="l00155"></a>00155   <span class="keywordtype">void</span> <a class="code" href="classSnowTools_1_1BamRead.html#a60e240793312c62580035d5eebc58ef2">SmartAddTag</a>(<span class="keyword">const</span> std::string&amp; tag, <span class="keyword">const</span> std::string&amp; val);
<a name="l00156"></a>00156   
<a name="l00158"></a><a class="code" href="classSnowTools_1_1BamRead.html#a9600062f79fb330c7ee41ec7bfad3d8c">00158</a>   <span class="keywordtype">void</span> <a class="code" href="classSnowTools_1_1BamRead.html#a9600062f79fb330c7ee41ec7bfad3d8c">SetMapQuality</a>(int32_t m) { b-&gt;core.qual = m; } 
<a name="l00159"></a>00159 
<a name="l00161"></a>00161   <span class="keywordtype">void</span> <a class="code" href="classSnowTools_1_1BamRead.html#a442309741df8c9c57a0ff91473b2e7ed">SetQname</a>(<span class="keyword">const</span> std::string&amp; n);
<a name="l00162"></a>00162 
<a name="l00164"></a>00164   <span class="keywordtype">void</span> <a class="code" href="classSnowTools_1_1BamRead.html#aca7f1f1a9f775d2a51daf9004fc48d29">SetSequence</a>(<span class="keyword">const</span> std::string&amp; seq);
<a name="l00165"></a>00165 
<a name="l00166"></a>00166   <span class="keyword">friend</span> std::ostream&amp; operator&lt;&lt;(std::ostream&amp; out, <span class="keyword">const</span> <a class="code" href="classSnowTools_1_1BamRead.html">BamRead</a> &amp;r);
<a name="l00167"></a>00167 
<a name="l00169"></a>00169   <a class="code" href="classSnowTools_1_1GenomicRegion.html">GenomicRegion</a> <a class="code" href="classSnowTools_1_1BamRead.html#a895659b8912b11a36ae970e60598c1a8">asGenomicRegion</a>() <span class="keyword">const</span>;
<a name="l00170"></a>00170 
<a name="l00172"></a><a class="code" href="classSnowTools_1_1BamRead.html#ac015633382d1cc7901559502e196025a">00172</a>   <span class="keyword">inline</span> uint32_t <a class="code" href="classSnowTools_1_1BamRead.html#ac015633382d1cc7901559502e196025a">MaxInsertionBases</a>()<span class="keyword"> const </span>{
<a name="l00173"></a>00173     uint32_t* c = bam_get_cigar(b);
<a name="l00174"></a>00174     uint32_t imax = 0;
<a name="l00175"></a>00175     <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; b-&gt;core.n_cigar; i++) 
<a name="l00176"></a>00176       <span class="keywordflow">if</span> (bam_cigar_opchr(c[i]) == <span class="charliteral">&apos;I&apos;</span>)
<a name="l00177"></a>00177         imax = std::max(bam_cigar_oplen(c[i]), imax);
<a name="l00178"></a>00178     <span class="keywordflow">return</span> imax;
<a name="l00179"></a>00179   }
<a name="l00180"></a>00180 
<a name="l00182"></a><a class="code" href="classSnowTools_1_1BamRead.html#a5b1bfd8a761030d2b08d8c73528b6544">00182</a>   <span class="keyword">inline</span> uint32_t <a class="code" href="classSnowTools_1_1BamRead.html#a5b1bfd8a761030d2b08d8c73528b6544">MaxDeletionBases</a>()<span class="keyword"> const </span>{
<a name="l00183"></a>00183     uint32_t* c = bam_get_cigar(b);
<a name="l00184"></a>00184     uint32_t dmax = 0;
<a name="l00185"></a>00185     <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; b-&gt;core.n_cigar; i++) 
<a name="l00186"></a>00186       <span class="keywordflow">if</span> (bam_cigar_opchr(c[i]) == <span class="charliteral">&apos;D&apos;</span>)
<a name="l00187"></a>00187         dmax = std::max(bam_cigar_oplen(c[i]), dmax);
<a name="l00188"></a>00188     <span class="keywordflow">return</span> dmax;
<a name="l00189"></a>00189   }
<a name="l00190"></a>00190 
<a name="l00192"></a><a class="code" href="classSnowTools_1_1BamRead.html#a6deb081aeeb1003f623dc6ad09ff2c19">00192</a>   <span class="keyword">inline</span> uint32_t <a class="code" href="classSnowTools_1_1BamRead.html#a6deb081aeeb1003f623dc6ad09ff2c19">NumMatchBases</a>()<span class="keyword"> const </span>{
<a name="l00193"></a>00193     uint32_t* c = bam_get_cigar(b);
<a name="l00194"></a>00194     uint32_t dmax = 0;
<a name="l00195"></a>00195     <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; b-&gt;core.n_cigar; i++) 
<a name="l00196"></a>00196       <span class="keywordflow">if</span> (bam_cigar_opchr(c[i]) == <span class="charliteral">&apos;M&apos;</span>)
<a name="l00197"></a>00197         dmax += bam_cigar_oplen(c[i]);
<a name="l00198"></a>00198     <span class="keywordflow">return</span> dmax;
<a name="l00199"></a>00199   }
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 
<a name="l00203"></a><a class="code" href="classSnowTools_1_1BamRead.html#ac0b4c8655d307fa4fc630e7e8117c3a6">00203</a>   Cigar <a class="code" href="classSnowTools_1_1BamRead.html#ac0b4c8655d307fa4fc630e7e8117c3a6">GetCigar</a>()<span class="keyword"> const </span>{
<a name="l00204"></a>00204     uint32_t* c = bam_get_cigar(b);
<a name="l00205"></a>00205     Cigar cig;
<a name="l00206"></a>00206     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; b-&gt;core.n_cigar; ++k) 
<a name="l00207"></a>00207       cig.push_back(<a class="code" href="structSnowTools_1_1CigarField.html">CigarField</a>(<span class="stringliteral">&quot;MIDSSHP=XB&quot;</span>[c[k]&amp;BAM_CIGAR_MASK], bam_cigar_oplen(c[k])));
<a name="l00208"></a>00208     <span class="keywordflow">return</span> cig;
<a name="l00209"></a>00209   }
<a name="l00210"></a>00210 
<a name="l00212"></a><a class="code" href="classSnowTools_1_1BamRead.html#a59c86bc15d8eee99c031b6dc8ca248b1">00212</a>   Cigar <a class="code" href="classSnowTools_1_1BamRead.html#a59c86bc15d8eee99c031b6dc8ca248b1">GetReverseCigar</a>()<span class="keyword"> const </span>{
<a name="l00213"></a>00213     uint32_t* c = bam_get_cigar(b);
<a name="l00214"></a>00214     Cigar cig;
<a name="l00215"></a>00215     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = b-&gt;core.n_cigar - 1; k &gt;= 0; --k) 
<a name="l00216"></a>00216       cig.push_back(<a class="code" href="structSnowTools_1_1CigarField.html">CigarField</a>(<span class="stringliteral">&quot;MIDSSHP=XB&quot;</span>[c[k]&amp;BAM_CIGAR_MASK], bam_cigar_oplen(c[k])));
<a name="l00217"></a>00217     <span class="keywordflow">return</span> cig;
<a name="l00218"></a>00218   }
<a name="l00219"></a>00219 
<a name="l00221"></a>00221   <span class="keywordtype">void</span> <a class="code" href="classSnowTools_1_1BamRead.html#af8101514ed57f41858aeb06f8f61ea08">clearSeqQualAndTags</a>();
<a name="l00222"></a>00222 
<a name="l00224"></a>00224   <span class="comment">/*inline */</span>std::string <a class="code" href="classSnowTools_1_1BamRead.html#a848ce46e52ffa3e2eba97345bf9edb22">Sequence</a>() <span class="keyword">const</span>;
<a name="l00225"></a>00225 
<a name="l00228"></a>00228   <span class="keywordtype">double</span> <a class="code" href="classSnowTools_1_1BamRead.html#a3428aa6681ce6c279fe5379d1c68daf5">MeanPhred</a>() <span class="keyword">const</span>;
<a name="l00229"></a>00229 
<a name="l00231"></a><a class="code" href="classSnowTools_1_1BamRead.html#a60509028b3c2b8adcb84d320f786b2ce">00231</a>   <span class="keyword">inline</span> std::string <a class="code" href="classSnowTools_1_1BamRead.html#a60509028b3c2b8adcb84d320f786b2ce">Qualities</a>()<span class="keyword"> const </span>{ 
<a name="l00232"></a>00232     uint8_t * p = bam_get_qual(b);
<a name="l00233"></a>00233     std::string out(b-&gt;core.l_qseq, <span class="charliteral">&apos; &apos;</span>);
<a name="l00234"></a>00234     <span class="keywordflow">for</span> (int32_t i = 0; i &lt; b-&gt;core.l_qseq; ++i) 
<a name="l00235"></a>00235       out[i] = (<span class="keywordtype">char</span>)(p[i]+33);
<a name="l00236"></a>00236     <span class="keywordflow">return</span> out;
<a name="l00237"></a>00237   }
<a name="l00238"></a>00238 
<a name="l00242"></a><a class="code" href="classSnowTools_1_1BamRead.html#a38bb030c2c0130e48c27bd33a3122bff">00242</a>   <span class="keyword">inline</span> int32_t <a class="code" href="classSnowTools_1_1BamRead.html#a38bb030c2c0130e48c27bd33a3122bff">AlignmentPositionReverse</a>()<span class="keyword"> const </span>{
<a name="l00243"></a>00243     uint32_t* c = bam_get_cigar(b);
<a name="l00244"></a>00244     int32_t p = 0;
<a name="l00245"></a>00245     <span class="keywordflow">for</span> (int32_t i = b-&gt;core.n_cigar - 1; i &gt;= 0; --i) {
<a name="l00246"></a>00246       <span class="keywordflow">if</span> ( (bam_cigar_opchr(c[i]) == <span class="charliteral">&apos;S&apos;</span>) || (bam_cigar_opchr(c[i]) == <span class="charliteral">&apos;H&apos;</span>))
<a name="l00247"></a>00247         p += bam_cigar_oplen(c[i]);
<a name="l00248"></a>00248       <span class="keywordflow">else</span> <span class="comment">// not a clip, so stop counting</span>
<a name="l00249"></a>00249         <span class="keywordflow">break</span>;
<a name="l00250"></a>00250     }
<a name="l00251"></a>00251     <span class="keywordflow">return</span> p;
<a name="l00252"></a>00252   }
<a name="l00253"></a>00253   
<a name="l00257"></a><a class="code" href="classSnowTools_1_1BamRead.html#a49fb5c59dbc95bb58f36ef119608c907">00257</a>   <span class="keyword">inline</span> int32_t <a class="code" href="classSnowTools_1_1BamRead.html#a49fb5c59dbc95bb58f36ef119608c907">AlignmentEndPositionReverse</a>()<span class="keyword"> const </span>{
<a name="l00258"></a>00258     uint32_t* c = bam_get_cigar(b);
<a name="l00259"></a>00259     int32_t p = 0;
<a name="l00260"></a>00260     <span class="keywordflow">for</span> (int32_t i = 0; i &lt; b-&gt;core.n_cigar; ++i) { <span class="comment">// loop from the end</span>
<a name="l00261"></a>00261       <span class="keywordflow">if</span> ( (bam_cigar_opchr(c[i]) == <span class="charliteral">&apos;S&apos;</span>) || (bam_cigar_opchr(c[i]) == <span class="charliteral">&apos;H&apos;</span>))
<a name="l00262"></a>00262         p += bam_cigar_oplen(c[i]);
<a name="l00263"></a>00263       <span class="keywordflow">else</span> <span class="comment">// not a clip, so stop counting</span>
<a name="l00264"></a>00264         <span class="keywordflow">break</span>;
<a name="l00265"></a>00265     }
<a name="l00266"></a>00266     <span class="keywordflow">return</span> (b-&gt;core.l_qseq - p);
<a name="l00267"></a>00267   }
<a name="l00268"></a>00268 
<a name="l00269"></a>00269 
<a name="l00272"></a><a class="code" href="classSnowTools_1_1BamRead.html#a964f96c94ac8cdab7a74178cd6366dad">00272</a>   <span class="keyword">inline</span> int32_t <a class="code" href="classSnowTools_1_1BamRead.html#a964f96c94ac8cdab7a74178cd6366dad">AlignmentPosition</a>()<span class="keyword"> const </span>{
<a name="l00273"></a>00273     uint32_t* c = bam_get_cigar(b);
<a name="l00274"></a>00274     int32_t p = 0;
<a name="l00275"></a>00275     <span class="keywordflow">for</span> (int32_t i = 0; i &lt; b-&gt;core.n_cigar; ++i) {
<a name="l00276"></a>00276       <span class="keywordflow">if</span> ( (bam_cigar_opchr(c[i]) == <span class="charliteral">&apos;S&apos;</span>) || (bam_cigar_opchr(c[i]) == <span class="charliteral">&apos;H&apos;</span>))
<a name="l00277"></a>00277         p += bam_cigar_oplen(c[i]);
<a name="l00278"></a>00278       <span class="keywordflow">else</span> <span class="comment">// not a clip, so stop counting</span>
<a name="l00279"></a>00279         <span class="keywordflow">break</span>;
<a name="l00280"></a>00280     }
<a name="l00281"></a>00281     <span class="keywordflow">return</span> p;
<a name="l00282"></a>00282   }
<a name="l00283"></a>00283   
<a name="l00286"></a><a class="code" href="classSnowTools_1_1BamRead.html#abc98a9ed00137658f5a6029627d2c691">00286</a>   <span class="keyword">inline</span> int32_t <a class="code" href="classSnowTools_1_1BamRead.html#abc98a9ed00137658f5a6029627d2c691">AlignmentEndPosition</a>()<span class="keyword"> const </span>{
<a name="l00287"></a>00287     uint32_t* c = bam_get_cigar(b);
<a name="l00288"></a>00288     int32_t p = 0;
<a name="l00289"></a>00289     <span class="keywordflow">for</span> (int32_t i = b-&gt;core.n_cigar - 1; i &gt;= 0; --i) { <span class="comment">// loop from the end</span>
<a name="l00290"></a>00290       <span class="keywordflow">if</span> ( (bam_cigar_opchr(c[i]) == <span class="charliteral">&apos;S&apos;</span>) || (bam_cigar_opchr(c[i]) == <span class="charliteral">&apos;H&apos;</span>))
<a name="l00291"></a>00291         p += bam_cigar_oplen(c[i]);
<a name="l00292"></a>00292       <span class="keywordflow">else</span> <span class="comment">// not a clip, so stop counting</span>
<a name="l00293"></a>00293         <span class="keywordflow">break</span>;
<a name="l00294"></a>00294     }
<a name="l00295"></a>00295     <span class="keywordflow">return</span> (b-&gt;core.l_qseq - p);
<a name="l00296"></a>00296   }
<a name="l00297"></a>00297 
<a name="l00299"></a><a class="code" href="classSnowTools_1_1BamRead.html#a06eace5fde4de4946bafd0271dae4c7f">00299</a>   <span class="keyword">inline</span> int32_t <a class="code" href="classSnowTools_1_1BamRead.html#a06eace5fde4de4946bafd0271dae4c7f">NumSoftClip</a>()<span class="keyword"> const </span>{
<a name="l00300"></a>00300       int32_t p = 0;
<a name="l00301"></a>00301       uint32_t* c = bam_get_cigar(b);
<a name="l00302"></a>00302       <span class="keywordflow">for</span> (int32_t i = 0; i &lt; b-&gt;core.n_cigar; ++i)
<a name="l00303"></a>00303         <span class="keywordflow">if</span> (bam_cigar_opchr(c[i]) == <span class="charliteral">&apos;S&apos;</span>)
<a name="l00304"></a>00304           p += bam_cigar_oplen(c[i]);
<a name="l00305"></a>00305       <span class="keywordflow">return</span> p;
<a name="l00306"></a>00306     }
<a name="l00307"></a>00307 
<a name="l00309"></a><a class="code" href="classSnowTools_1_1BamRead.html#aaa36a12f467323318b31011f9e72b8a6">00309</a>   <span class="keyword">inline</span> int32_t <a class="code" href="classSnowTools_1_1BamRead.html#aaa36a12f467323318b31011f9e72b8a6">NumHardClip</a>()<span class="keyword"> const </span>{
<a name="l00310"></a>00310       int32_t p = 0;
<a name="l00311"></a>00311       uint32_t* c = bam_get_cigar(b);
<a name="l00312"></a>00312       <span class="keywordflow">for</span> (int32_t i = 0; i &lt; b-&gt;core.n_cigar; ++i) 
<a name="l00313"></a>00313         <span class="keywordflow">if</span> (bam_cigar_opchr(c[i]) == <span class="charliteral">&apos;H&apos;</span>)
<a name="l00314"></a>00314           p += bam_cigar_oplen(c[i]);
<a name="l00315"></a>00315       <span class="keywordflow">return</span> p;
<a name="l00316"></a>00316     }
<a name="l00317"></a>00317 
<a name="l00318"></a>00318 
<a name="l00320"></a><a class="code" href="classSnowTools_1_1BamRead.html#affadd7f1657d8dd6838067294f9db2c9">00320</a>   <span class="keyword">inline</span> int32_t <a class="code" href="classSnowTools_1_1BamRead.html#affadd7f1657d8dd6838067294f9db2c9">NumClip</a>()<span class="keyword"> const </span>{
<a name="l00321"></a>00321     int32_t p = 0;
<a name="l00322"></a>00322     uint32_t* c = bam_get_cigar(b);
<a name="l00323"></a>00323     <span class="keywordflow">for</span> (int32_t i = 0; i &lt; b-&gt;core.n_cigar; ++i)
<a name="l00324"></a>00324       <span class="keywordflow">if</span> ( (bam_cigar_opchr(c[i]) == <span class="charliteral">&apos;S&apos;</span>) || (bam_cigar_opchr(c[i]) == <span class="charliteral">&apos;H&apos;</span>) )
<a name="l00325"></a>00325         p += bam_cigar_oplen(c[i]);
<a name="l00326"></a>00326     <span class="keywordflow">return</span> p;
<a name="l00327"></a>00327   }
<a name="l00328"></a>00328   
<a name="l00333"></a>00333   std::string <a class="code" href="classSnowTools_1_1BamRead.html#a35a81a15d80b25d069f315becdeac88f">GetZTag</a>(<span class="keyword">const</span> std::string&amp; tag) <span class="keyword">const</span>;
<a name="l00334"></a>00334   
<a name="l00339"></a>00339   std::vector&lt;int&gt; <a class="code" href="classSnowTools_1_1BamRead.html#a5d3fa999fe77fa623ed4ae37c3cc661f">GetSmartIntTag</a>(<span class="keyword">const</span> std::string&amp; tag) <span class="keyword">const</span>;
<a name="l00340"></a>00340 
<a name="l00345"></a>00345   std::vector&lt;std::string&gt; <a class="code" href="classSnowTools_1_1BamRead.html#ab76ce21af871fe90c7b828aa8c3124b3">GetSmartStringTag</a>(<span class="keyword">const</span> std::string&amp; tag) <span class="keyword">const</span>;
<a name="l00346"></a>00346 
<a name="l00351"></a><a class="code" href="classSnowTools_1_1BamRead.html#aabe3d89e97fccb2c1bdc23655ca396e4">00351</a>   <span class="keyword">inline</span> int32_t <a class="code" href="classSnowTools_1_1BamRead.html#aabe3d89e97fccb2c1bdc23655ca396e4">GetIntTag</a>(<span class="keyword">const</span> std::string&amp; tag)<span class="keyword"> const </span>{
<a name="l00352"></a>00352     uint8_t* p = bam_aux_get(b.get(),tag.c_str());
<a name="l00353"></a>00353     <span class="keywordflow">if</span> (!p)
<a name="l00354"></a>00354       <span class="keywordflow">return</span> 0;
<a name="l00355"></a>00355     <span class="keywordflow">return</span> bam_aux2i(p);
<a name="l00356"></a>00356   }
<a name="l00357"></a>00357 
<a name="l00358"></a>00358 
<a name="l00363"></a>00363   <span class="keywordtype">void</span> <a class="code" href="classSnowTools_1_1BamRead.html#ac61f4df863735aa2ddfc7f54d66ba0f4">AddZTag</a>(std::string tag, std::string val);
<a name="l00364"></a>00364 
<a name="l00369"></a><a class="code" href="classSnowTools_1_1BamRead.html#abe98e023ba9d4bf5420fc048772b2c81">00369</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classSnowTools_1_1BamRead.html#abe98e023ba9d4bf5420fc048772b2c81">AddIntTag</a>(<span class="keyword">const</span> std::string&amp; tag, int32_t val) {
<a name="l00370"></a>00370     bam_aux_append(b.get(), tag.data(), <span class="charliteral">&apos;i&apos;</span>, 4, (uint8_t*)&amp;val);
<a name="l00371"></a>00371   }
<a name="l00372"></a>00372 
<a name="l00376"></a><a class="code" href="classSnowTools_1_1BamRead.html#a12e19312481cb669198668585ed263a0">00376</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classSnowTools_1_1BamRead.html#a12e19312481cb669198668585ed263a0">SetID</a>(int32_t <span class="keywordtype">id</span>) {
<a name="l00377"></a>00377     b-&gt;core.tid = id;
<a name="l00378"></a>00378   }
<a name="l00379"></a>00379   
<a name="l00383"></a><a class="code" href="classSnowTools_1_1BamRead.html#a1ef1594d552f155f92ba4fa6ffaf6c7d">00383</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classSnowTools_1_1BamRead.html#a1ef1594d552f155f92ba4fa6ffaf6c7d">SetPosition</a>(int32_t pos) {
<a name="l00384"></a>00384     b-&gt;core.pos = pos;
<a name="l00385"></a>00385   }
<a name="l00386"></a>00386 
<a name="l00389"></a><a class="code" href="classSnowTools_1_1BamRead.html#a6c495a1389b8a22cd969a506ed366723">00389</a>   <span class="keyword">inline</span> std::string <a class="code" href="classSnowTools_1_1BamRead.html#a6c495a1389b8a22cd969a506ed366723">CigarString</a>()<span class="keyword"> const </span>{
<a name="l00390"></a>00390     std::stringstream cig;
<a name="l00391"></a>00391     uint32_t* c = bam_get_cigar(b);
<a name="l00392"></a>00392     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; b-&gt;core.n_cigar; ++k)
<a name="l00393"></a>00393       cig &lt;&lt; bam_cigar_oplen(c[k]) &lt;&lt; <span class="stringliteral">&quot;MIDNSHP=XB&quot;</span>[c[k]&amp;BAM_CIGAR_MASK];
<a name="l00394"></a>00394     <span class="keywordflow">return</span> cig.str();
<a name="l00395"></a>00395   }
<a name="l00396"></a>00396   
<a name="l00402"></a><a class="code" href="classSnowTools_1_1BamRead.html#a1036efccc7eb4586738fea267085b386">00402</a>   <span class="keyword">inline</span> std::string <a class="code" href="classSnowTools_1_1BamRead.html#a1036efccc7eb4586738fea267085b386">ChrName</a>()<span class="keyword"> const </span>{
<a name="l00403"></a>00403 
<a name="l00404"></a>00404     <span class="comment">// if we have the header, convert</span>
<a name="l00405"></a>00405     <span class="keywordflow">if</span> (m_hdr) {
<a name="l00406"></a>00406       <span class="keywordflow">if</span> (b-&gt;core.tid &lt; m_hdr-&gt;n_targets)
<a name="l00407"></a>00407         <span class="keywordflow">return</span> std::string(m_hdr-&gt;target_name[b-&gt;core.tid]);
<a name="l00408"></a>00408       <span class="keywordflow">else</span>
<a name="l00409"></a>00409         <span class="keywordflow">return</span> <span class="stringliteral">&quot;CHR_ERROR&quot;</span>;
<a name="l00410"></a>00410     }
<a name="l00411"></a>00411 
<a name="l00412"></a>00412     <span class="comment">// no header, assume zero based</span>
<a name="l00413"></a>00413     <span class="keywordflow">return</span> std::to_string(b-&gt;core.tid + 1);
<a name="l00414"></a>00414     
<a name="l00415"></a>00415   }
<a name="l00416"></a>00416 
<a name="l00418"></a><a class="code" href="classSnowTools_1_1BamRead.html#a7b93e694343dbe1bcb52c3434136b1ed">00418</a>   <span class="keyword">inline</span> std::string <a class="code" href="classSnowTools_1_1BamRead.html#a7b93e694343dbe1bcb52c3434136b1ed">Brief</a>(bam_hdr_t * h = <span class="keyword">nullptr</span>)<span class="keyword"> const </span>{
<a name="l00419"></a>00419     <span class="keywordflow">if</span> (!h)
<a name="l00420"></a>00420       <span class="keywordflow">return</span>(std::to_string(b-&gt;core.tid + 1) + <span class="stringliteral">&quot;:&quot;</span> + AddCommas&lt;int32_t&gt;(b-&gt;core.pos) + <span class="stringliteral">&quot;(&quot;</span> + ((b-&gt;core.flag&amp;BAM_FREVERSE) != 0 ? <span class="stringliteral">&quot;+&quot;</span> : <span class="stringliteral">&quot;-&quot;</span>) + <span class="stringliteral">&quot;)&quot;</span>);
<a name="l00421"></a>00421     <span class="keywordflow">else</span>
<a name="l00422"></a>00422       <span class="keywordflow">return</span>(std::string(h-&gt;target_name[b-&gt;core.tid]) + <span class="stringliteral">&quot;:&quot;</span> + AddCommas&lt;int32_t&gt;(b-&gt;core.pos) + <span class="stringliteral">&quot;(&quot;</span> + ((b-&gt;core.flag&amp;BAM_FREVERSE) != 0 ? <span class="stringliteral">&quot;+&quot;</span> : <span class="stringliteral">&quot;-&quot;</span>) + <span class="stringliteral">&quot;)&quot;</span>);      
<a name="l00423"></a>00423   }
<a name="l00424"></a>00424 
<a name="l00426"></a><a class="code" href="classSnowTools_1_1BamRead.html#a8103590ca7a93ecf7708cbd225ca5a95">00426</a>   <span class="keyword">inline</span> std::string <a class="code" href="classSnowTools_1_1BamRead.html#a8103590ca7a93ecf7708cbd225ca5a95">BriefMate</a>(bam_hdr_t * h = <span class="keyword">nullptr</span>)<span class="keyword"> const </span>{
<a name="l00427"></a>00427     <span class="keywordflow">if</span> (!h)
<a name="l00428"></a>00428       <span class="keywordflow">return</span>(std::to_string(b-&gt;core.mtid + 1) + <span class="stringliteral">&quot;:&quot;</span> + AddCommas&lt;int32_t&gt;(b-&gt;core.mpos) + <span class="stringliteral">&quot;(&quot;</span> + ((b-&gt;core.flag&amp;BAM_FMREVERSE) != 0 ? <span class="stringliteral">&quot;+&quot;</span> : <span class="stringliteral">&quot;-&quot;</span>) + <span class="stringliteral">&quot;)&quot;</span>);
<a name="l00429"></a>00429     <span class="keywordflow">else</span>
<a name="l00430"></a>00430       <span class="keywordflow">return</span>(std::string(h-&gt;target_name[b-&gt;core.mtid]) + <span class="stringliteral">&quot;:&quot;</span> + AddCommas&lt;int32_t&gt;(b-&gt;core.mpos) + <span class="stringliteral">&quot;(&quot;</span> + ((b-&gt;core.flag&amp;BAM_FMREVERSE) != 0 ? <span class="stringliteral">&quot;+&quot;</span> : <span class="stringliteral">&quot;-&quot;</span>) + <span class="stringliteral">&quot;)&quot;</span>);      
<a name="l00431"></a>00431   }
<a name="l00432"></a>00432 
<a name="l00433"></a>00433 
<a name="l00437"></a><a class="code" href="classSnowTools_1_1BamRead.html#ae30193b6e1f7ab38e9a7379c62ee269c">00437</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classSnowTools_1_1BamRead.html#ae30193b6e1f7ab38e9a7379c62ee269c">RemoveTag</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* tag) {
<a name="l00438"></a>00438     uint8_t* p = bam_aux_get(b.get(), tag);
<a name="l00439"></a>00439     <span class="keywordflow">if</span> (p)
<a name="l00440"></a>00440       bam_aux_del(b.get(), p);
<a name="l00441"></a>00441   }
<a name="l00442"></a>00442 
<a name="l00444"></a><a class="code" href="classSnowTools_1_1BamRead.html#a125b73c6ab23363d25daee2fd4eed65a">00444</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classSnowTools_1_1BamRead.html#a125b73c6ab23363d25daee2fd4eed65a">RemoveAllTags</a>() {
<a name="l00445"></a>00445     <span class="keywordtype">size_t</span> keep = (b-&gt;core.n_cigar&lt;&lt;2) + b-&gt;core.l_qname + ((b-&gt;core.l_qseq + 1)&gt;&gt;1) + b-&gt;core.l_qseq;
<a name="l00446"></a>00446     b-&gt;data = (uint8_t*)realloc(b-&gt;data, keep); <span class="comment">// free the end, which has aux data</span>
<a name="l00447"></a>00447     b-&gt;l_data = keep;
<a name="l00448"></a>00448     b-&gt;m_data = b-&gt;l_data;
<a name="l00449"></a>00449   }
<a name="l00450"></a>00450 
<a name="l00452"></a><a class="code" href="classSnowTools_1_1BamRead.html#ac8a8e932ebee9ad1abe2f4deafc23b31">00452</a>   <span class="keyword">inline</span> bam1_t* <a class="code" href="classSnowTools_1_1BamRead.html#ac8a8e932ebee9ad1abe2f4deafc23b31">raw</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> b.get(); }
<a name="l00453"></a>00453   
<a name="l00454"></a>00454   <span class="comment">//std::string toSam(bam_hdr_t* h) const;</span>
<a name="l00455"></a>00455   
<a name="l00456"></a>00456   <span class="keyword">private</span>:
<a name="l00457"></a>00457 
<a name="l00458"></a>00458   <span class="comment">//bam_hdr_h *hdr;</span>
<a name="l00459"></a>00459   <span class="comment">//bam1_t * b;</span>
<a name="l00460"></a>00460   std::shared_ptr&lt;bam1_t&gt; b;
<a name="l00461"></a>00461   std::shared_ptr&lt;bam_hdr_t&gt; m_hdr;
<a name="l00462"></a>00462 };
<a name="l00463"></a>00463 
<a name="l00464"></a>00464  <span class="keyword">typedef</span> std::vector&lt;BamRead&gt; BamReadVector; 
<a name="l00465"></a>00465  
<a name="l00466"></a>00466  <span class="keyword">typedef</span> std::vector&lt;BamReadVector&gt; BamReadClusterVector;
<a name="l00467"></a>00467 
<a name="l00468"></a>00468  <span class="keyword">namespace </span>BamReadSort {
<a name="l00469"></a>00469 
<a name="l00470"></a>00470    <span class="comment">// sort by read position</span>
<a name="l00471"></a><a class="code" href="structSnowTools_1_1BamReadSort_1_1ByReadPosition.html">00471</a>    <span class="keyword">struct </span><a class="code" href="structSnowTools_1_1BamReadSort_1_1ByReadPosition.html">ByReadPosition</a>
<a name="l00472"></a>00472    {
<a name="l00473"></a>00473      <span class="keywordtype">bool</span> operator()( <span class="keyword">const</span> <a class="code" href="classSnowTools_1_1BamRead.html">BamRead</a>&amp; lx, <span class="keyword">const</span> <a class="code" href="classSnowTools_1_1BamRead.html">BamRead</a>&amp; rx )<span class="keyword"> const </span>{
<a name="l00474"></a>00474        <span class="keywordflow">return</span> (lx.<a class="code" href="classSnowTools_1_1BamRead.html#afbd518132e9a953ba6b4059f273b5168">ChrID</a>() &lt; rx.<a class="code" href="classSnowTools_1_1BamRead.html#afbd518132e9a953ba6b4059f273b5168">ChrID</a>()) || (lx.<a class="code" href="classSnowTools_1_1BamRead.html#afbd518132e9a953ba6b4059f273b5168">ChrID</a>() == rx.<a class="code" href="classSnowTools_1_1BamRead.html#afbd518132e9a953ba6b4059f273b5168">ChrID</a>() &amp;&amp; lx.<a class="code" href="classSnowTools_1_1BamRead.html#a6fd3f2218c3245356bd3f841616d208e">Position</a>() &lt; rx.<a class="code" href="classSnowTools_1_1BamRead.html#a6fd3f2218c3245356bd3f841616d208e">Position</a>());
<a name="l00475"></a>00475      }
<a name="l00476"></a>00476    };
<a name="l00477"></a>00477 
<a name="l00478"></a>00478    <span class="comment">// sort by read mate position</span>
<a name="l00479"></a><a class="code" href="structSnowTools_1_1BamReadSort_1_1ByMatePosition.html">00479</a>    <span class="keyword">struct </span><a class="code" href="structSnowTools_1_1BamReadSort_1_1ByMatePosition.html">ByMatePosition</a>
<a name="l00480"></a>00480    {
<a name="l00481"></a>00481      <span class="keywordtype">bool</span> operator()( <span class="keyword">const</span> <a class="code" href="classSnowTools_1_1BamRead.html">BamRead</a>&amp; lx, <span class="keyword">const</span> <a class="code" href="classSnowTools_1_1BamRead.html">BamRead</a>&amp; rx )<span class="keyword"> const </span>{
<a name="l00482"></a>00482        <span class="keywordflow">return</span> (lx.<a class="code" href="classSnowTools_1_1BamRead.html#a26c0c601f0843ebb0e3ad6523ec9ba79">MateChrID</a>() &lt; rx.<a class="code" href="classSnowTools_1_1BamRead.html#a26c0c601f0843ebb0e3ad6523ec9ba79">MateChrID</a>()) || (lx.<a class="code" href="classSnowTools_1_1BamRead.html#a26c0c601f0843ebb0e3ad6523ec9ba79">MateChrID</a>() == rx.<a class="code" href="classSnowTools_1_1BamRead.html#a26c0c601f0843ebb0e3ad6523ec9ba79">MateChrID</a>() &amp;&amp; lx.<a class="code" href="classSnowTools_1_1BamRead.html#a6a602cda286b646dd00170fec4bdd353">MatePosition</a>() &lt; rx.<a class="code" href="classSnowTools_1_1BamRead.html#a6a602cda286b646dd00170fec4bdd353">MatePosition</a>());
<a name="l00483"></a>00483      }
<a name="l00484"></a>00484    };
<a name="l00485"></a>00485 
<a name="l00486"></a>00486 }
<a name="l00487"></a>00487 
<a name="l00488"></a>00488 }
<a name="l00489"></a>00489 <span class="preprocessor">#endif</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 16 Jan 2016 for SnowTools by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
